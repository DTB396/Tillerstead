{%- comment -%}
  Breadcrumb Navigation
  - Omitted on homepage or when page.breadcrumb == false
  - Uses schema.org BreadcrumbList for SEO
  - Accessible with aria-label and proper landmark roles
{%- endcomment -%}

{%- if page.url == "/" or page.breadcrumb == false -%}
  {%- comment -%}Hidden on home or when disabled{%- endcomment -%}
{%- else -%}
  {%- assign path = page.url | replace: 'index.html', '' -%}
  {%- assign segments = path | split: '/' -%}

  <nav class="breadcrumbs" aria-label="Page breadcrumbs">
    <ol class="breadcrumbs-list"
        itemscope
        itemtype="https://schema.org/BreadcrumbList"
        role="list">
      
      {%- assign position = 1 -%}

      <!-- Home Link -->
      <li itemprop="itemListElement"
          itemscope
          itemtype="https://schema.org/ListItem"
          role="listitem">
        <a itemprop="item"
           href="{{ '/' | relative_url }}"
           class="breadcrumb-link">
          <span itemprop="name">Home</span>
        </a>
        <meta itemprop="position" content="{{ position }}">
      </li>

      {%- assign position = position | plus: 1 -%}
      {%- assign current_path = "" -%}

      <!-- Path segments -->
      {%- for segment in segments -%}
        {%- if segment == "" -%}
          {%- continue -%}
        {%- endif -%}

        {%- assign current_path = current_path | append: "/" | append: segment -%}
        {%- assign is_last = forloop.last -%}

        {%- if is_last -%}
          {%- assign label = page.breadcrumb_title | default: page.title | default: segment | replace: '-', ' ' | capitalize -%}
        {%- else -%}
          {%- assign label = segment | replace: '-', ' ' | capitalize -%}
        {%- endif -%}

        <li itemprop="itemListElement"
            itemscope
            itemtype="https://schema.org/ListItem"
            role="listitem">
          <a itemprop="item"
             href="{{ current_path | append: '/' | relative_url }}"
             class="breadcrumb-link"
             {%- if is_last %} aria-current="page"{%- endif %}>
            <span itemprop="name">{{ label }}</span>
          </a>
          <meta itemprop="position" content="{{ position }}">
        </li>

        {%- assign position = position | plus: 1 -%}
      {%- endfor -%}

    </ol>
  </nav>
{%- endif -%}